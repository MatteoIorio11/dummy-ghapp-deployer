AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: Serverless GitHub app
Resources:
  webhooks:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: ${{ secrets.LAMBDA_FUNCTION }}
      Description: Basic Auth Funtion
      CodeUri: webhooks
      Handler: handler.webhooks
      Runtime: nodejs16.x
      Events:
        ApiEvent:
          Type: HttpApi
      Environment:
        Variables:
          APP_ID: ${{ secrets.AWS_GHAPP_ID }}
          WEBHOOK_SECRET: ${{ secrets.AWS_GHAPP_WEBHOOK_SECRET }}
          PRIVATE_KEY: ${{ secrets.AWS_GHAPP_PRIVATE_KEY }}
    Metadata:
      SamResourceId: webhooks
